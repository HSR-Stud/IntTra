\section{Lineare Differenzialgleichungen}
\begin{figure}[H] \centering
  \input{tex/diffeq-laplace}
  \caption{
    Schematische Darstellung des Prozesses um lineare Differenzialgleichungen
    zu l\"osen.
  }
\end{figure}

\subsection{Laplace Transformierte der Ableitung}
\[
  \laplace\left\{ y^{(k)} \right\} =
  s^k Y(s) - \sum_{j = 0}^{k - 1} s^{k-j} y^{(j)}
\]

\subsection{Partialbruchzerlegung}
Seien \(P\) und \(Q\) Polynomen von \(s\).
Der Nenner \(Q(s)\) kann in einem Produkt von \(n\) linearen und \(m\)
quadratischen Terme faktorisiert werden, dass heisst mit Terme von der Form
\(\ell (s) = s - r\) und \(q(s) = a s^2 + b s + c\).
%
Die Partialbruchzerlegung macht im einfachsten Fall aus den Produkt
\(1/(\ell \cdot q)\) eine Summe \(A/\ell + (Bs + C)/q\). Mit mehre Faktoren es
muss zu jedem \(\ell\) und \(q\) einen \emph{eindeutigen} Z\"ahler (\(A\) bzw.
\(Bs + C\)) zugeordnet werden.
%
\begin{align*}
  \frac{P(s)}{Q(s)}
  =
  \frac{P(s)}{
    \colorbox{teal!20}{\(
      \ell_1(s)\cdots \ell_n(s)
    \)}
    \cdot
    \colorbox{purple!20}{\(
      q_1(s)\cdots q_m(s)
    \)}
  }
  &=
  \colorbox{teal!20}{\(\displaystyle
    \sum_{j=1}^n \sum_{k=1}^{u_j} \frac{A_{jk}}{(s - r_j)^k}
  \)}
  +
  \colorbox{purple!20}{\(\displaystyle
    \sum_{j=1}^m \sum_{k=1}^{w_j} \frac{B_{jk} s + C_{jk}}{(a_j s^2 + b_j s + c_j)^k}
  \)}
\end{align*}

Wenn 2 oder allgemeiner \(u\) Faktoren \(\ell_j, \ell_{j+1},\dots,\ell_{j+u}\)
in der Faktorisierung gleich sind, dann sind sie als \(\ell_j(s)^{u}\)
zusammengefasst. Auf \"ahnliche Weise wenn \(q_j = \cdots = q_{j+w}\), es gibt dann
\(q_j(s)^{w}\).
%
Diese m\"ussen jedoch verschiedene Z\"ahler haben, somit potenziert man die
(gleiche) Nenner \(\ell_j, \ell_{j+1}, \dots\) mit steigenden Potenzen um sie
von einander zu unterscheiden.
Sonst, weil
\(\ell_j = \ell_{j+1} \textcolor{gray}{= \cdots = \ell_{j+u}}\), ist
\begin{align*}
  \frac{A_j}{\ell_j} + \frac{A_{j+1}}{\ell_{j+1}} =
    \frac{A_j + A_{j+1}}{\ell_j} = \frac{A'_j}{\ell_j}
  \quad\text{unerw\"unscht! }\implies\quad
  \frac{A_j}{\ell_j} + \frac{A_{j+1}}{\ell_{j+1}^2} =
    \frac{A_{j1}}{\ell_j} + \frac{A_{j2}}{\ell_j^2}
      \begingroup\color{gray}
        + \frac{A_{jk}}{\ell_j^k}
      \endgroup
\end{align*}

Dasselbe ist auch f\"ur \(q_j\) mit \(B_{jk}s + C_{jk}\).
Jedes \(A, B\) und \(C\) wird mittels Koeffizientenvergleich zu \(P(s)\) durch
ein lineares Gleichungssystem (z.B. in Matrixform) bestimmt.
Beispiel: Hier sind
  \colorbox{teal!20}{\(n = 1\)},
  \textcolor{blue}{\(u_1 = 2\)} und
  \colorbox{purple!20}{\(m = 1\)},
  \textcolor{red!80!black}{\(w_1 = 1\)}.
\begin{align*}
  \frac{3}{
    \colorbox{teal!20}{\(
      (s + 3)^{\textcolor{blue}{2}}
    \)}
    \cdot
    \colorbox{purple!20}{\(
      (s^2 + 9)^{\textcolor{red}{1}}
    \)}
  }
  &=
  \colorbox{teal!20}{\(\displaystyle
    \frac{A_{11}}{s + 3} +
    \frac{A_{12}}{(s + 3)^2}
  \)}
  +
  \colorbox{purple!20}{\(\displaystyle
    \frac{B_{11} s + C_{11}}{s^2 + 9}
  \)}
  \\
  3 &= A_{11} (s + 3)(s^2 + 9) + A_{12} (s^2 + 9) + (B_{11} s + C_{11})(s + 3)^2 \\
  \begingroup\color{gray}0s^3 + 0s^2 + 0s^1 +\endgroup 3s^0 &=
    A_{11} (s^3 + 3s^2 + 9s + 27) +
    A_{12} (s^2 + 9) +
    B_{11} (s^3 + 6s^2 + 9s) +
    C_{11} (s^2 +6s + 9)
\end{align*}
Das Gleichungssystem in \(\mathcal{P}_{n+m}(\mathbf{R})\)
\[
  \mathcal{Q}\vec{k} = \vec{p} \iff
  \begingroup\color{lightgray}
    \begin{matrix}
      s^3 \\ s^2 \\ s^1 \\ s^0
    \end{matrix}
  \endgroup
  \begin{bmatrix}
     1 & 0 & 1 & 0 \\
     3 & 1 & 6 & 1 \\
     9 & 0 & 9 & 6 \\
    27 & 9 & 0 & 9 
  \end{bmatrix}
  \begin{bmatrix}
    A_{11} \\ A_{12} \\ B_{11} \\ C_{11}
  \end{bmatrix} =
  \begin{bmatrix}
    0 \\ 0 \\ 0 \\ 3
  \end{bmatrix}
  \quad\implies\quad
  \vec{k} = \mathcal{Q}^{-1} \vec{p} =
    \frac{1}{18}
    \begin{bmatrix}
      1 \\ 3 \\  -1 \\ 0
    \end{bmatrix}
\]
% \(\vec{A}, \vec{B}, \vec{C}, \vec{P} \in \mathcal{P}(\mathbf{C})\)
% \[
%   \begin{bmatrix}
%     \v{A} \\ \v{B} \\ \v{C}
%   \end{bmatrix}
%   = \v{P}
% \]
